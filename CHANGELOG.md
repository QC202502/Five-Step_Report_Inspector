# 五步法研报分析器更新日志

## v0.7.5 (2025-07-03)

### 修复
- 修复评级和日期标签页点击跳转到首页的问题
- 统一所有筛选功能的实现方式，提高代码一致性
- 确保所有标签页链接正确指向对应的筛选页面

## v0.7.4 (2025-07-02)

### 新增功能
- 在研报详情页添加标签式报告元数据导航
- 添加按研究机构、行业、评级、发布日期进行筛选的功能
- 新增评级和日期筛选页面，丰富数据查询功能

### 改进
- 优化研报详情页布局，使用标签页展示研报关键信息
- 添加点击跳转功能，便于用户快速查看相关研报
- 增强UI交互体验，提升用户数据浏览效率

## v0.7.3 (2025-07-01)

### 改进
- 优化研报详情页面布局，添加研报信息概览卡片
- 改进用户界面，在研报详情页显示研报标题、机构、日期、评级、股票和行业信息
- 增强响应式设计，支持在不同设备上良好显示研报信息

## v0.7.2 (2025-06-25)

### 新增功能
- 添加智能推荐系统，基于用户阅读历史进行个性化推荐
- 增加阅读历史页面，支持查看、筛选、排序和导出历史记录
- 支持CSV和JSON两种格式导出阅读历史
- 优化推荐引擎，考虑用户历史阅读偏好自动调整推荐权重

### 改进
- 改进阅读历史记录功能，支持记录阅读时长和完成状态
- 优化用户界面，添加阅读历史入口和操作按钮
- 增强数据隐私保护，根据用户隐私设置决定是否记录阅读历史
- 完善导航栏，添加阅读历史快捷入口

### 修复
- 修复阅读历史与旧版已读记录的兼容性问题
- 解决多用户环境下阅读历史混淆的问题

## v0.7.1 (2025-06-20)

### 新增功能
- 添加用户偏好设置系统，支持个性化配置
- 实现用户阅读历史和搜索历史记录功能
- 添加用户数据隐私控制，允许用户选择是否收集历史数据
- 开发用户设置页面，包含推荐设置、通知设置、阅读偏好和隐私设置
- 添加用户数据导出和删除功能，符合数据隐私保护要求

### 改进
- 优化用户体验，添加更多个性化选项
- 改进数据库结构，添加用户偏好和历史记录表
- 完善用户界面，添加设置入口和操作按钮
- 增强数据隐私保护，用户可控制数据收集范围

### 修复
- 修复用户设置与推荐系统集成问题
- 解决用户偏好数据存储和读取的边缘情况

## v0.7.0 (2025-06-15)

### 新增功能
- 添加用户注册和登录功能，支持用户身份验证
- 创建用户数据表结构，包括用户表、用户资料表和会话表
- 开发用户资料页面，支持查看和编辑个人信息
- 实现会话管理和基本安全措施，包括密码哈希存储和会话令牌
- 添加用户权限管理功能，支持管理员和普通用户角色
- 将推荐系统与用户系统集成，实现个性化推荐

### 改进
- 更新导航栏，添加用户登录/注册和用户菜单
- 为所有用户操作添加权限控制
- 优化会话管理，支持"记住我"功能
- 改进数据库结构，添加外键约束

### 修复
- 修复推荐设置与用户关联的问题
- 解决已读状态跨用户混淆的问题

## v0.6.1 (2025-06-10)

### 新增功能
- 添加研报推荐功能，基于五步法评分、时间新鲜度和行业相关性进行智能推荐
- 新增推荐设置页面，允许用户调整推荐因素权重和偏好行业
- 添加已读/未读状态管理，支持标记研报为已读或不感兴趣
- 实现推荐弹窗，登录时显示最高推荐分数的研报

### 改进
- 优化首页布局，添加推荐研报区域
- 改进研报详情页，添加已读/未读状态和操作按钮
- 添加CSS样式，美化推荐卡片和未读标记

### 修复
- 修复app.py中的缩进错误问题
- 添加数据库迁移脚本，创建推荐系统所需的表结构

## v0.6.0 (2025-06-09)

### 新增功能
- 添加视频脚本生成功能，基于五步法分析结果生成投资顾问口播文案
- 新增视频脚本API端点，支持生成和获取脚本内容

### 改进
- 优化DeepSeek API调用参数，提高文案生成质量
- 增加文案生成的字数上限，支持更详细的内容展示
- 完善五步法分析维度在文案中的呈现
- 改进文本处理逻辑，确保生成内容的可读性和完整性

### 修复
- 修复API密钥配置问题
- 解决会话密钥缺失导致的运行时错误

## v0.5.0 (2025-06-09)

### 新增功能
- 无

### 改进
- 移除Claude分析器，专注使用DeepSeek API
- 自动更新README.md中的版本号和分析器描述

### 修复
- 无

## v0.5.0 (2025-06-09)

### 架构优化
- 移除Claude分析器，专注使用DeepSeek API进行五步法分析
- 移除关键词分析方法，提高分析质量和一致性
- 简化代码结构，减少依赖

### 改进
- 优化DeepSeek API调用流程，提高分析效率
- 简化前端界面，统一使用DeepSeek分析结果展示
- 改进API密钥管理，支持通过.env文件配置

### 修复
- 修复环境变量加载问题
- 修复前端模板中的分析器选择逻辑

## v0.4.1 (2025-06-07)

### 数据库更新
- 新增5篇研报数据，丰富了数据库内容
- 完成了研报的DeepSeek分析并存储到数据库
- 优化了数据库存储结构，提高查询效率

### 改进
- 改进了批量爬取和分析流程，提高了稳定性
- 优化了分析结果的存储和展示方式
- 完善了五步法分析结果的评分系统

## v0.4.0 (2025-05-23)

### 新增功能
- 集成 DeepSeek API 进行研报分析，提供高质量的五步法分析结果
- 添加研报爬取与 DeepSeek 分析的完整流程测试脚本 `test_crawl_and_analyze.py`
- 优化分析结果存储结构，支持多种分析器（Claude/DeepSeek）的结果并存

### 改进
- 优化 DeepSeek 分析器的提示词和结果解析逻辑
- 改进研报内容爬取的稳定性和成功率
- 完善分析结果在数据库中的存储结构

### 修复
- 修复 API 密钥配置问题，现在可以通过环境变量正确设置 DeepSeek API 密钥
- 解决中文编码问题，确保分析结果正确显示

### 其他
- 更新文档，添加 DeepSeek 分析器的使用说明
- 代码结构优化，提高可维护性

## v0.3.2 (2025-05-20)

### 新增功能
- 添加研报详情页面
- 实现研报列表分页功能

### 改进
- 优化数据库查询性能
- 改进前端界面交互体验

### 修复
- 修复部分研报无法正确解析的问题
- 解决数据库连接泄漏问题

## v0.3.1 - 2025-05-23

### 修复

- 修复研报详情页链接问题：使用数据库真实ID替代循环索引，解决了404错误问题
- 修复了模板文件中的链接生成逻辑，确保正确访问研报详情页
- 更新了`.gitignore`文件，优化了敏感信息和临时文件的排除规则

## v0.3.0 - 2025-05-23

### 新增功能

- 集成DeepSeek API进行研报分析
- 支持从数据库中获取研报并进行分析
- 完善五步法分析结构化输出
- 添加分析结果评分系统

### 改进

- 优化API调用错误处理
- 增强分析结果解析能力
- 提供详细的分析报告格式

### 修复

- 修复中文编码问题
- 修复API调用超时处理

## v0.2.3 - 2025-05-23

### 修复 (Fixes)

- 修复了在 `database.py` 中多个函数 (`get_reports_from_db`, `get_reports_by_industry`, `search_reports`) 错误删除 `id` 字段的问题，确保 `app.py` 可以正确访问研报ID。
- 修复了 `app.py` 中 `load_reports_from_db` 函数在处理从数据库加载的研报数据时，由于 `id` 字段缺失导致的错误。
- 修复了 `app.py` 中 `stats_page` 统计页面因分析步骤 (`steps`) 数据结构不一致（列表与字典）而导致的错误。

### 改进 (Improvements)

- 更新了 `app.py` 中的辅助函数 (`calculate_completeness_score`, `get_completeness_description`, `get_improvement_suggestions`) 以兼容列表和字典两种格式的分析步骤数据结构，增强了数据处理的鲁棒性。

## v0.2.2 - 2025-05-22

### 新增功能

- 全新改进的用户界面，美观且符合现代设计标准
- 添加统计分析页面，展示研报分布、评分分析和行业分布等
- 添加行业和机构筛选功能，方便按类别查看研报
- 添加搜索功能，支持按关键词搜索研报
- 改进研报详情页，添加雷达图展示五步法评分
- 添加404和500错误页面，提升用户体验

### 改进

- 优化数据库访问逻辑，修复数据加载问题
- 改进爬取过程的用户交互，添加实时状态更新
- 使用Bootstrap 5和Font Awesome改进UI组件
- 添加响应式设计，适配各种屏幕尺寸
- 添加API端点获取版本信息

### 修复

- 修复数据库访问错误
- 修复研报内容展示问题
- 改进错误处理和异常管理

## v0.2.1 - 2025-05-22

### 改进

- 移除了处理10篇研报的限制，现在可以处理所有爬取的研报数据
- 完善异常处理，确保单个报告处理失败不会影响整体流程

## v0.2.0 - 2025-05-22

### 新增功能

- 添加数据库功能，持久化存储研报数据
- 实现研报数据的导入/导出功能
- 添加更多错误处理和日志记录

## v0.1.0 - 2025-05-22

### 初始版本

- 基本的五步法分析功能
- 实现网页爬虫功能，获取东方财富网研报数据
- 使用Claude进行研报智能分析
- 基本的Web界面展示分析结果

## v0.3.2 - 2025-05-23

### 改进
- 数据库结构优化：删除旧版的analysis_results和report_full_analysis表，减少数据冗余
- 代码重构：更新数据库访问接口，统一使用AnalysisDatabase类
- 性能优化：减少数据库存储空间，提高查询效率
